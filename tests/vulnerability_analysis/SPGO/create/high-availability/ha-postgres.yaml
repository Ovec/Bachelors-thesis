apiVersion: v1
kind: Secret
metadata:
  name: my-cluster-minio
type: Opaque
data:
  secretkey: YWRtaW4=
  accesskey: MWYyZDFlMmU2N2Rm
---
apiVersion: stackgres.io/v1
kind: SGInstanceProfile
metadata:
  name: small
  # namespace: postgres-operator
spec:
  cpu: "1"
  memory: "100Mi"
---
apiVersion: stackgres.io/v1
kind: SGCluster
metadata:
  name: postgres-node
  # namespace: postgres-operator
spec:
  instances: 2
  sgInstanceProfile: small
  postgres:
    version: '14'
  pods:
    persistentVolume: 
      size: '1Gi'
---
apiVersion: stackgres.io/v1
kind: SGPoolingConfig
metadata:
  name: pgbouncerconf
spec:
  pgBouncer:
    pgbouncer.ini:
      pgbouncer:
        max_client_conn: '2000'
        default_pool_size: '50'
---
apiVersion: stackgres.io/v1beta1
kind: SGObjectStorage
metadata:
  name: objectstorage
spec:
  type: s3Compatible
  s3Compatible:
    bucket: stackgres
    region: k8s
    enablePathStyleAddressing: true
    endpoint: http://my-cluster-minio:9000
    awsCredentials:
      secretKeySelectors:
        accessKeyId:
          key: accesskey
          name: my-cluster-minio
        secretAccessKey:
          key: secretkey
          name: my-cluster-minio




